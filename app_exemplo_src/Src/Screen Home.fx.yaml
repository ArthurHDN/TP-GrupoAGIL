"'Screen Home' As screen":
    LoadingSpinnerColor: =RGBA(100, 118, 132, 1)
    OnVisible: |
        =Set(varAppBarAction,0);
        Set(varSelectedMenu,1);
        Set(varStepAction,0);
        Set(varAttachmentAction,false);
        Set(varActionConfirmDelete,false);
        Set(varDeleteItem,false);
        Set(varExpandedMenu,false);
        Set(varNewProccessAction,false);
        Set(varFormType,"Edit");
        Set(varStepsInfo,false);
        
        Set(varLabelStep1,"Solicitação RH");
        Set(varLabelStep2,"Cadastro DP");
        Set(varLabelStep3,"Cadastro Funcionário");
        Set(varLabelStep4,"Validação DP");
        Set(varLabelStep5,"Cadastro CCI");
        Set(varLabelStep6,"Boas-vindas RH");
        Set(varLabelStep7,"Boas-vindas RH");
        Set(varLabelStep8,"Boas-vindas RH");
        Set(varLabelStep9,"Boas-vindas RH");
        Set(varLabelStep10,"Boas-vindas RH");

    tmrHomeNewProccess As timer:
        Duration: =1
        Fill: =RGBA(56, 96, 178, 1)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        OnTimerEnd: |
            =Set(varEditItem,true);
            Set(varFormType,"New");
            
            Reset(txtNomeFuncionario);Reset(cmbCargo);Reset(dteDataAdmissao);
            Reset(cmbGestor);Reset(cmbCentroCusto);Reset(cmbDepartamento);
            Reset(txtSalario);Reset(rdbMotivoContratacao);Reset(rdbClienteProjeto);
            Reset(cmbCliente);Reset(rdbTreinamentoCliente);Reset(cmbTipoTreinamento);
            Reset(rdbEquipamento);Reset(rdbQualEquipamento);Reset(rdbKitBoasVindas);
            Reset(rdbPerifericos);Reset(cbxTeclado);Reset(cbxMouse);Reset(cbxSuporte);
            Reset(rdbCelularCorporativo);Reset(txtObservacoes);
            
            Navigate('Screen Solicitação RH',None);
            Set(varNewProccessAction,false);
        Reset: =varNewProccessAction=false
        Start: =varNewProccessAction=true
        Visible: =false
        X: =703
        Y: =728
        ZIndex: =1

    tmrActionsGaleryAttachments As timer:
        Duration: =1
        Fill: =RGBA(56, 96, 178, 1)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        OnTimerEnd: |
            =Set(varCurrentItem,LookUp(colAdmissao,Title=StepsGallery_1.SelectedItem.Title));
            Download(varCurrentItem.'Link para o item');
            Set(varAttachmentAction,false);
        Reset: =varAttachmentAction=false
        Start: =varAttachmentAction=true
        Visible: =false
        X: =487
        Y: =728
        ZIndex: =2

    tmrActionsStepsGalleryDelete As timer:
        Duration: =1
        Fill: =RGBA(56, 96, 178, 1)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        OnTimerEnd: |
            =Concurrent(
                Patch(colAdmissao,LookUp(colAdmissao,Title=varCurrentItem.Title),{
                    Status:"Cancelado",
                    'Cancelado por': User().Email,
                    'Cancelado Timestamp': Now()}
                ),
                Patch('[DPE_001] Admissão',LookUp('[DPE_001] Admissão',Title=varCurrentItem.Title),{
                    Status:"Cancelado",
                    'Cancelado por': User().Email,
                    'Cancelado Timestamp': Now()}
                )
            );
            
            'Admissão-NotificarTeams'.Run(varCurrentItem.Title,"Cancelado");
            
            Set(varActionConfirmDelete,false);
            
            Notify("Item deletado com sucesso!",Success);
        Reset: =varActionConfirmDelete=false
        Start: =varActionConfirmDelete=true
        Visible: =false
        X: =342
        Y: =728
        ZIndex: =3

    tmrHomeStepAction As timer:
        Duration: =1
        Fill: =RGBA(56, 96, 178, 1)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        OnTimerEnd: |-
            =Set(varCurrentItem,LookUp(colAdmissao,Title=StepsGallery_1.SelectedItem.Title));
            
            Switch(
                varStepAction,1,
                    Set(varEditItem,true);
                    Reset(txtNomeFuncionario);Reset(cmbCargo);Reset(dteDataAdmissao);
                    Reset(cmbGestor);Reset(cmbCentroCusto);Reset(cmbDepartamento);
                    Reset(txtSalario);Reset(rdbMotivoContratacao);Reset(rdbClienteProjeto);
                    Reset(cmbCliente);Reset(rdbTreinamentoCliente);Reset(cmbTipoTreinamento);
                    Reset(rdbEquipamento);Reset(rdbQualEquipamento);Reset(rdbKitBoasVindas);
                    Reset(rdbPerifericos);Reset(cbxTeclado);Reset(cbxMouse);Reset(cbxSuporte);
                    Reset(rdbCelularCorporativo);Reset(txtObservacoes);
            
                    Navigate('Screen Solicitação RH',None),
            
                2,
                    Reset(txtEmailFuncionario);
                    Navigate('Screen Cadastro DP',None),
            
                4,
                    Set(varDPApproval,true);
            
                    Concurrent(
                        Reset(txtEmailPessoal);Reset(txtNomeCompleto);
                        Reset(txtSexo);Reset(txtRaca);
                        Reset(dteDataNascimento);Reset(txtEstadoCivil);
                        Reset(txtCidadeNascimento);Reset(txtEstadoNascimento);
                        Reset(txtNomeMae);Reset(txtNomePai);
                        Reset(rdbPortadorDeficiencia);Reset(txtTipoDeficiencia),
            
                        Reset(txtCEP);Reset(txtNumeroEndereco);
                        Reset(txtComplementoEndereco);Reset(txtLogradouroEndereco);
                        Reset(txtBairroEndereco);Reset(txtCidadeEndereco);
                        Reset(txtEstadoEndereco);Reset(txtNumeroTelefone);
                        Reset(txtContatoEmergencia),
            
                        Reset(txtCPF);Reset(txtRG);
                        Reset(dteDataRG);Reset(txtOrgaoEmissor);
                        Reset(txtEstadoOrgaoEmissor);Reset(rdbCarteiraDigital);
                        Reset(txtNumeroCTPS);Reset(txtSerieCTPS);
                        Reset(dteDataCTPS);Reset(rdbPrimeiroEmprego);
                        Reset(txtNumeroPIS),
            
                        Reset(rdbPlanoMedico);Reset(rdbTransporteAeromedico);
                        Reset(rdbPlanoOdontologico),
            
                        Reset(txtNomeDependente1);Reset(txtCPFDependente1);
                        Reset(dteDataNascimentoDependente1);Reset(txtSexoDependente1);
                        Reset(txtEstadoCivilDependente1);Reset(txtNomeMaeDependente1);
                        Reset(txtAdicionaisDependente1),
            
                        Reset(txtNomeDependente2);Reset(txtCPFDependente2);
                        Reset(dteDataNascimentoDependente2);Reset(txtSexoDependente2);
                        Reset(txtEstadoCivilDependente2);Reset(txtNomeMaeDependente2);
                        Reset(txtAdicionaisDependente2),
            
                        Reset(txtNomeDependente3);Reset(txtCPFDependente3);
                        Reset(dteDataNascimentoDependente3);Reset(txtSexoDependente3);
                        Reset(txtEstadoCivilDependente3);Reset(txtNomeMaeDependente3);
                        Reset(txtAdicionaisDependente3),
            
                        Reset(txtNomeDependente4);Reset(txtCPFDependente4);
                        Reset(dteDataNascimentoDependente4);Reset(txtSexoDependente4);
                        Reset(txtEstadoCivilDependente4);Reset(txtNomeMaeDependente4);
                        Reset(txtAdicionaisDependente4),
            
                        Reset(txtNomeDependente5);Reset(txtCPFDependente5);
                        Reset(dteDataNascimentoDependente5);Reset(txtSexoDependente5);
                        Reset(txtEstadoCivilDependente5);Reset(txtNomeMaeDependente5);
                        Reset(txtAdicionaisDependente5)
                    );
            
                    Navigate('Screen Cadastro Funcionário',None),
            
                5,
                    Reset(txtGruposRede); Reset(txtUsuarioEmail); Reset(txtUsuarioRede);
                    Reset(dteDataEntregaEquipamento); Reset(dteDataEnvioEquipamento);
                    Reset(rdbEnviadoCorreios); Reset(rdbAdicionadoListaNotebook);
                    Reset(rdbAdicionadoIDMSMS); Reset(rdbEnviadoSenhaInicial);
            
                    Navigate('Screen Cadastro CCI',None),
                
                6,
                    Reset(rdbDiaRecepcao);
                    Navigate('Screen Boas Vindas RH',None)
            );
            Set(varStepAction,0);
        Reset: =varStepAction=0 || App.ActiveScreen.Name<>"Screen Home"
        Start: =varStepAction<>0 && App.ActiveScreen.Name="Screen Home"
        Visible: =false
        X: =202
        Y: =728
        ZIndex: =4

    tmrHomeAppBarAction As timer:
        Duration: =1
        Fill: =RGBA(56, 96, 178, 1)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        OnTimerEnd: |-
            =Switch(
                varAppBarAction,
                1,
                    Concurrent(
                        Refresh('[DPE_001] Admissão');ClearCollect(colAdmissao,'[DPE_001] Admissão'),
            
                        Refresh('[DPE_001] Centros de Custo');ClearCollect(colCentrosdeCusto,'[DPE_001] Centros de Custo'),
            
                        Refresh('[DPE_001] Departamentos');ClearCollect(colDepartamentos,'[DPE_001] Departamentos'),
            
                        Refresh('[DPE_001] Cargos');ClearCollect(colCargos,'[DPE_001] Cargos'),
            
                        Refresh('[DPE_001] Permissões');ClearCollect(colPermissoes,'[DPE_001] Permissões'),
            
                        Refresh('[DPE_001] Gestores');ClearCollect(colGestores,'[DPE_001] Gestores'),
            
                        Refresh('[DPE_001] Dependentes');ClearCollect(colDependentes,'[DPE_001] Dependentes')
                    );
                    Notify("Dados atualizados com sucesso!",Success),
                2,
                    If(varStepsInfo,Set(varStepsInfo,false),Set(varStepsInfo,true)),        
                3,
                    
                4,
                    If(varPermissionsAdmin || varPermissionsDev,
                    Navigate('Screen Settings',None),
                    Notify("Somente usuários administradores podem acessas as configurações do app!",NotificationType.Information)
            )
                    
            );
            
            Set(varAppBarAction,0);
        Reset: =varAppBarAction=0 || App.ActiveScreen.Name<>"Screen Home"
        Start: =varAppBarAction<>0 && App.ActiveScreen.Name="Screen Home"
        Visible: =false
        X: =54
        Y: =728
        ZIndex: =5

    LateralBar_1 As LateralBar:
        Height: =663
        NumberIcons: =2
        ThemeColor: =ColorSuccess.Color
        Y: =105
        ZIndex: =6

    AppBar_1 As AppBar:
        Logo: =vetta
        MyPermissionsTooltip: |-
            =Concatenate(
                "Suas permissões: " & Char(10) &
                If(varPermissionsRH || varPermissionsAdmin || varPermissionsDev,"➣ RH" & Char(10),""),
                If(varPermissionsDP || varPermissionsAdmin || varPermissionsDev,"➣ DP" & Char(10),""),
                If(varPermissionsCCI || varPermissionsAdmin || varPermissionsDev,"➣ CCI" & Char(10),""),
                If(varPermissionsDelete || varPermissionsAdmin || varPermissionsDev,"➣ ❌ Deletar" & Char(10),""),
                If(varPermissionsAdmin || varPermissionsDev,"➣ 🔑 Administrar" & Char(10),"")
            )
        ShowButton: =false
        Title: ="Admissão"
        ZIndex: =7

    StepsGallery_1 As StepsGallery:
        DisplayMode1: =If(StepsGallery_1.SelectedItem.'Etapa Atual'>=1,Edit,View)
        DisplayMode10: =If(StepsGallery_1.SelectedItem.'Etapa Atual'>=1,Edit,View)
        DisplayMode2: =If(StepsGallery_1.SelectedItem.'Etapa Atual'>=2,Edit,View)
        DisplayMode3: =DisplayMode.View
        DisplayMode4: =If(StepsGallery_1.SelectedItem.'Etapa Atual'>=4,Edit,View)
        DisplayMode5: =If(StepsGallery_1.SelectedItem.'Etapa Atual'>=5,Edit,View)
        DisplayMode6: =If(StepsGallery_1.SelectedItem.'Etapa Atual'>=6,Edit,View)
        DisplayMode7: =If(StepsGallery_1.SelectedItem.'Etapa Atual'>=7,Edit,View)
        DisplayMode8: =If(StepsGallery_1.SelectedItem.'Etapa Atual'>=1,Edit,View)
        DisplayMode9: =If(StepsGallery_1.SelectedItem.'Etapa Atual'>=1,Edit,View)
        Height: =663
        Items: =SortByColumns(FirstN(Filter(colAdmissao,(varSearchText in Title || varSearchText in '1 Nome Colaborador') && Status=varStatusFilter),50),varOrderBy,varSortBy)
        PermissionsAdmin: =varPermissionsAdmin
        PermissionsDelete: =varPermissionsDelete
        PermissionsDev: =varPermissionsDev
        StepsColorSuccess: =ColorSuccess.Color
        Width: |-
            =If(varExpandedMenu,
                Max(App.Width, App.MinScreenWidth)-LateralBar_1.Width,
                Max(App.Width, App.MinScreenWidth)-LateralBar_1.Width)
        X: =If(varExpandedMenu,LateralBar_1.Width,LateralBar_1.Width)
        Y: =105
        ZIndex: =8

    NewProccess_1 As NewProccess:
        Fill: =Transparent
        Theme: =ColorSuccess.Color
        X: =1262
        Y: =666
        ZIndex: =9

    StepsInfo_1 As StepsInfo:
        Color: =White
        Fill: =Transparent
        Text: |-
            ="Permissões do app:" & Char(10) & Char(10) &
            "➣ RH:" & Char(10) & Concat(colPermissoes,If("@vetta.digital" in Step1,Step1 & Char(10))) &
            Char(10) & "➣ RH:" & Char(10) & Concat(colPermissoes,If("@vetta.digital" in Step2,Step2 & Char(10))) &
            Char(10) & "➣ CCI:" & Char(10) & Concat(colPermissoes,If("@vetta.digital" in Step3,Step3 & Char(10))) &
            Char(10) & "➣ ❌ Deletar:" & Char(10) & Concat(colPermissoes,If("@vetta.digital" in Delete,Delete & Char(10))) &
            Char(10) & "➣ 🔑 Administrar:" & Char(10) & Concat(colPermissoes,If("@vetta.digital" in Admin,Admin & Char(10)))
        Theme: =ColorStepsInfo.Color
        Visible: =varStepsInfo
        Y: =105
        ZIndex: =10

    drpDevPermissions As dropdown:
        BorderColor: =RGBA(32, 54, 71, 1)
        ChevronBackground: =RGBA(100, 118, 132, 1)
        ChevronDisabledBackground: =RGBA(166, 166, 166, 1)
        ChevronDisabledFill: =RGBA(244, 244, 244, 1)
        ChevronHoverBackground: =ColorFade(RGBA(100, 118, 132, 1), -20%)
        ChevronHoverFill: =RGBA(255, 255, 255, 1)
        DisabledBorderColor: =RGBA(166, 166, 166, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisabledFill: =RGBA(244, 244, 244, 1)
        Height: =21
        HoverColor: =RGBA(0, 0, 0, 1)
        HoverFill: =RGBA(205, 209, 213, 1)
        Items: =["RH","DP","CCI","Admin","Dev","Delete"]
        OnChange: |-
            =Switch(Self.Selected.Value,
                "RH",Set(varPermissionsRH,true);Set(varPermissionsDP,false);Set(varPermissionsCCI,false);Set(varPermissionsAdmin,false);Set(varPermissionsDev,false);Set(varPermissionsDelete,false),
                "DP",Set(varPermissionsRH,false);Set(varPermissionsDP,true);Set(varPermissionsCCI,false);Set(varPermissionsAdmin,false);Set(varPermissionsDev,false);Set(varPermissionsDelete,false),
                "CCI",Set(varPermissionsRH,false);Set(varPermissionsDP,false);Set(varPermissionsCCI,true);Set(varPermissionsAdmin,false);Set(varPermissionsDev,false);Set(varPermissionsDelete,false),
                "Admin",Set(varPermissionsRH,false);Set(varPermissionsDP,false);Set(varPermissionsCCI,false);Set(varPermissionsAdmin,true);Set(varPermissionsDev,false);Set(varPermissionsDelete,false),
                "Dev",Set(varPermissionsRH,false);Set(varPermissionsDP,false);Set(varPermissionsCCI,false);Set(varPermissionsAdmin,false);Set(varPermissionsDev,true);Set(varPermissionsDelete,false),
                "Delete",Set(varPermissionsRH,false);Set(varPermissionsDP,false);Set(varPermissionsCCI,false);Set(varPermissionsAdmin,false);Set(varPermissionsDev,false);Set(varPermissionsDelete,true))
        PressedColor: =RGBA(255, 255, 255, 1)
        PressedFill: =RGBA(32, 54, 71, 1)
        SelectionFill: =RGBA(100, 118, 132, 1)
        Size: =13
        Visible: =User().Email="powerplatform@vetta.digital"
        Width: =71
        X: =703
        Y: =25
        ZIndex: =11

