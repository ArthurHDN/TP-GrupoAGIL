"'Screen Boas Vindas RH' As screen.'phoneLayout_FluidGridWithHeaderPageLayout_ver3.0'":
    Fill: =
    LoadingSpinnerColor: =RGBA(100, 118, 132, 1)
    OnVisible: =Set(varAppBarAction,0);

    cnvForm1_4 As fluidGrid.fluidGridWithBlankCard:
        BorderStyle: =BorderStyle.None
        BorderThickness: =0
        ContentLanguage: =
        Height: =658
        NumberOfColumns: =3
        Width: =Parent.Width
        Y: =110
        ZIndex: =3

        dtcDiaRecepcao As dataCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            BorderThickness: =0
            DisplayMode: =If((varPermissionsRH || varPermissionsAdmin || varPermissionsDev),Edit,View)
            Fill: =RGBA(0, 0, 0, 0)
            Height: =100
            Width: =Parent.Width
            X: =0
            Y: =1
            ZIndex: =1

            rdbDiaRecepcao As radio:
                BorderColor: =RGBA(32, 54, 71, 1)
                BorderStyle: =BorderStyle.None
                Color: =RGBA(0, 0, 0, 1)
                Default: =varCurrentItem.'6 Dia Recepcao'
                Font: =Font.'Segoe UI'
                Height: =70
                HoverColor: =RGBA(32, 54, 71, 1)
                Items: =["Segunda-feira","Quarta-feira"]
                Layout: =Vertical
                RadioBorderColor: =RGBA(32, 54, 71, 1)
                RadioSize: =25
                Size: =13
                Width: =250
                X: =15
                Y: =35
                ZIndex: =1

            lblDiaRecepcao As label:
                BorderColor: =RGBA(32, 54, 71, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Size: =13
                Text: ="Dia da recepção *"
                Width: =259
                X: =20
                ZIndex: =2

        dtcSectionDisparoEmail_1 As dataCard.blankCard:
            BorderColor: =RGBA(0, 0, 0, 1)
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =If((varPermissionsDP || varPermissionsAdmin || varPermissionsDev),Edit,View)
            Fill: =RGBA(0, 0, 0, 0)
            Height: =77
            Width: =1365
            X: =0
            Y: =0
            ZIndex: =2

            lblSectionDisparoEmail_1 As label:
                BorderColor: =RGBA(32, 54, 71, 1)
                Color: =RGBA(0, 0, 0, 1)
                DisabledColor: =RGBA(166, 166, 166, 1)
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =34
                OnSelect: |-
                    =If(varStep3DadosPessoais,UpdateContext({varStep3DadosPessoais:false}),UpdateContext({varStep3DadosPessoais:true}))
                Size: =20
                Text: ="Disparo de E-mail"
                Width: =334
                X: =20
                Y: =21
                ZIndex: =1

            shpAppTitleDivider_16 As rectangle:
                BorderColor: =RGBA(32, 54, 71, 1)
                Fill: =RGBA(204, 204, 204, 1)
                Height: =0.5
                Width: =1316
                X: =20
                Y: =61
                ZIndex: =2

    AppBar_6 As AppBar:
        Action2: =false
        Action3: =false
        Action4: =false
        ButtonIcon: =Icon.Mail
        ButtonText: ="Enviar Email"
        ButtonWidth: =155
        Icon1: =Icon.Home
        Logo: =vetta
        ShowButton: =If((varPermissionsRH || varPermissionsAdmin || varPermissionsDev),true,false)
        Title: ="Boas Vindas RH"
        ZIndex: =20

    tmrBoasVindasRHAction As timer:
        Duration: =1
        Fill: =RGBA(56, 96, 178, 1)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        OnTimerEnd: |-
            =Switch(
                varAppBarAction,
                1,
                    Navigate('Screen Home')
                    
            );
            
            Set(varAppBarAction,0);
        Reset: =varAppBarAction=0 || App.ActiveScreen.Name<>'Screen Boas Vindas RH'.Name
        Start: =varAppBarAction<>0 && App.ActiveScreen.Name='Screen Boas Vindas RH'.Name
        Visible: =false
        X: =54
        Y: =728
        ZIndex: =21

    tmrBoasVindasRHButtonAction As timer:
        Duration: =1
        Fill: =RGBA(56, 96, 178, 1)
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =ColorFade(RGBA(56, 96, 178, 1), -20%)
        OnTimerEnd: |-
            =If(varActionAppBarButton,
                If(
                    IsBlank(rdbDiaRecepcao.Selected.Value),
            
                    Notify("Existem campos obrigatórios a serem preenchidos!",Error),
                        Concurrent(
                            Patch(colAdmissao,LookUp(colAdmissao,Title=varCurrentItem.Title),
                                {
                                    'Etapa Atual': 7,
                                    Status: "Finalizado",
                                    '6 Responsavel':User().Email,
                                    '6 Timestamp':Now(),
                                    '6 Dia Recepcao': rdbDiaRecepcao.Selected.Value,
                                    'Finalizado por': User().Email,
                                    'Finalizado Timestamp': Now()
                                }
                            ),
                            Patch('[DPE_001] Admissão',LookUp('[DPE_001] Admissão',Title=varCurrentItem.Title),
                                {
                                    'Etapa Atual': 7,
                                    Status: "Finalizado",
                                    '6 Responsavel':User().Email,
                                    '6 Timestamp':Now(),
                                    '6 Dia Recepcao': rdbDiaRecepcao.Selected.Value,
                                    'Finalizado por': User().Email,
                                    'Finalizado Timestamp': Now()
                                }
                            )
                        );
                        'Admissão-EmailBoasVindas'.Run(
                            varCurrentItem.'2 Email Funcionario',
                            Text(varCurrentItem.'1 Data admissao',ShortDate),
                            varCurrentItem.'1 Nome Colaborador',
                            varCurrentItem.'6 Dia Recepcao',
                            varCurrentItem.'1 Gestor',
                            varCurrentItem.'1 Departamento'
                        );
                        Notify("Seu email de boas-vindas foi enviado para " & varCurrentItem.'2 Email Funcionario',Success);
                        'Admissão-NotificarTeams'.Run(varCurrentItem.Title,"Finalizado");
                        Navigate('Screen Home',None)
                )      
            );
            
            Set(varActionAppBarButton,false);
        Reset: =!varActionAppBarButton || App.ActiveScreen.Name<>'Screen Boas Vindas RH'.Name
        Start: =varActionAppBarButton && App.ActiveScreen.Name='Screen Boas Vindas RH'.Name
        Visible: =false
        X: =74
        Y: =728
        ZIndex: =22

